# 데이터베이스 구조와 성능
## 1. 슈퍼/서브타입 데이터 모델의 성능고려 방법
### 가. 슈퍼/서브타입 데이터 모델의 개요
  - 슈퍼/서브타입 데이터 모델 : Extended ER모델이라고 부름. 최근 데이터 모델링을 할 때 자주 쓰이는 모델링 방법
      - 자주 쓰이는 이유 : 업무를 구성하는 데이터의 특징을 공통점과 차이점의 특징을 고려하여 효과적으로 표현할 수 있기 때문이다. 
      - 즉, 공통부분을 슈퍼타입으로 모델링하고 공통으로부터 상속받아 다른 엔터티와 차이가 있는 속성에 대해서는 별도의 서브엔터티로 구분하여 정확히 표현
      - 이는 물리적인 데이터 모델로 변활 할 떄 선택의 폭을 넓힐 수 있다.
  
### 나. 슈퍼/서브타입 데이터 모델의 변환
  - 변환 기준: 데이터 양과 해당 테이블에 발생되는 트랜잭션의 유형
  - 잘못된 변환으로 인한 성능저하 케이스
      1) 트랜잭션은 항상일괄로 처리하는데 테이블을 개별로 유지되어 Union 연산에 의해 성능 저하
      2) 트랜잭션은 항상 서브타입 개별로 처리하는데, 테이블은 하나로 통합되어 있어 불필요하게 많은 양의 데이터가 집약되어 있어 성능 저하
      3) 트랜잭션은 항상 슈퍼+서브 타입을 공통으로 처리하는데 개별로 유지되어 있거나 하나의 테이블로 집약되어 있어 성능이 저하되는 경우
  
### 다. 슈퍼/서브타입 데이터 모델의 변환기술
  1) 개별로 발생되는 트랜잭션에 대해서는 개별 테이블로 구성
      - 슈퍼타입이 각 서브타입에 대해 기준역할을 하는 형식으로 사용할 때, 트랜잭션이 개별적으로 발생
      - 슈퍼타입에는 꼭 필요한 속성만을 가짐.
      - 서브타입에도 꼭 필요한 속성 및 자신의 타입에 맞는 데이터만 가짐.

  2) 슈퍼타입+서브타입에 대해 발생되는 트랜잭션에 대해서는 슈퍼타입+서브타입 테이블로 구성
      - 슈퍼타입 아래에 상속받는 서브타입 테이블을 구성하는 것과 달리 (1개의 슈퍼타입 테이블 + n개의 서브타입 테이블)
      - 서브타입 내에 각 슈퍼타입 속성을 포함시켜, 서브타입 수만큼 테이블을 구성 ( n개의 독립적인 테이블 )

  3) 전체를 하나로 묶어 트랜잭션이 발생할 때는 하나의 테이블로 구성
      - 슈퍼타입과 서브타입의 테이블들을 하나로 묶었을 때 각각의 속성별로 제약사항(NULL/NOT NULL, 기본값, 체크값)을 정확하게 지정못할 수 있음.
      - 그러나 대용량이고 성능향상이 필요하다면 하나의 테이블로 묶어서 구성한다.

### 라. 슈퍼/서브타입 데이터 모델의 변환타입 비교
  - SQLD_기본서 통합본 p.79 [표 I -2-4] 참고 

## 2. 인덱스 특성을 고려한 PK/FK 데이터베이스 성능 향상
### 가. PK/FK 칼럼 순서와 성능 개요
  - 인덱스 : 데이터를 조회할 때 가장 효과적으로 처리될 수 있도록 접근경로를 제공하는 오브젝트
      - 여러 개의 속성이 하나의 인덱스로 구성될 때, 앞쪽에 위치한 속성의 값이 비교자로 있어야 좋은 효율을 나타냄.
      - 앞쪽에 위치한 속성 값이 가급적 '=' 아니면 최소한 범위 'BETWEEN' '<>'가 들어와야 인덱스를 이용할 수 있음.
  - PK/FK는 데이터를 접근할 때 경로를 제공하는 성능적 측면에서도 중요한 의미를 가짐.
  - PK가 복합식별자 일 때, 상속받아 발생되는 속성순서까지 주의하여 표시하도록 한다.
 
### 나. PK칼럼의 순서를 조정하지 않으면 성능이 저하되는 이유
  - 테이블에 접근하는 트랜잭션의 특징에 효율적이지 않은 인덱스가 생성
  - 인덱스 범위를 넓게 이용하거나 Full Scan을 유발하게 되어 성능이 저하됨.

### 다. PK순서를 잘못 지정하여 성능이 저하된 경우 - 간단한 오류
  - 테이블에 데이터를 조회할 때, 빈번하게 들어오는 속성을 PK순서에서 앞에 배치한다.
  - 이는 FULL TABLE SCAN을 방지하여 성능 저하를 막을 뿐만 아니라 성능이 개선된 모습을 보여줌.

### 라. PK순서를 잘못 지정하여 성능이 저하된 경우 - 복잡한 오류
  - PK순서변경을 통한 인덱스 생성 : 더 빠르게 소분류로 구분해주는 PK속성을 인덱스의 앞에 위치시키도록 한다. (범위 좁히기)
  
## 3. 물리적인 테이블에 FK제약이 걸려있지 않을 경우 인덱스 미생성으로 성능저하
  - 물리적인 테이블에 FK 제약 걸었을 때는 반드시 FK인덱스를 생성하도록 한다.
  - FK제약이 걸리지 않았을 경우, FK인덱스를 생성하는 것을 기본정책으로 한다.
  - 발생되는 트랜잭션에 의해 거의 활용되지 않는 경우, FK인덱스를 지운다.
